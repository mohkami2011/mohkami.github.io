// Google Apps Script (Code.gs) - paste in Apps Script editor and deploy as Web App (Anyone, even anonymous)
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.openById("PUT_YOUR_SHEET_ID_HERE").getSheetByName("Sheet1");
    const data = JSON.parse(e.postData.contents);
    sheet.appendRow([new Date(), data.name, data.email, data.phone, data.date, data.time, data.code, data.location, data.contactMethod, data.budget]);
    const to = "your@yourdomain.com";
    const subject = "New Appointment Request - MOHKAMI";
    const body = "New appointment:\n\n" + JSON.stringify(data, null, 2);
    MailApp.sendEmail(to, subject, body);
    return ContentService.createTextOutput(JSON.stringify({status:'ok'})).setMimeType(ContentService.MimeType.JSON);
  } catch(err) {
    return ContentService.createTextOutput(JSON.stringify({status:'error', message: err.message})).setMimeType(ContentService.MimeType.JSON);
  }
}
